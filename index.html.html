<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Special Message For You</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --purple-light: #f5f3ff;
            --purple-accent: #d8b4fe;
            --purple-mid: #8b5cf6;
            --purple-dark: #5b21b6;
            --sakura-pink: #ffd1dc;
            --letter-bg: #ffffff;
            --text-main: #312e81;
            --pink-accent: #ec4899;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            min-height: 100vh;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle at center, #2e1065 0%, #0f172a 100%);
            font-family: 'Quicksand', sans-serif;
            overflow: hidden;
            perspective: 1200px;
            touch-action: manipulation;
        }

        /* Ambient Glow */
        body::after {
            content: '';
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at center, transparent 30%, rgba(0,0,0,0.4) 100%);
            pointer-events: none;
            z-index: 2;
        }

        /* Sakura Petals */
        .sakura-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .petal {
            position: absolute;
            background-color: var(--sakura-pink);
            border-radius: 150% 0 150% 0;
            opacity: 0.7;
            animation: fall linear infinite;
            will-change: transform;
        }

        @keyframes fall {
            0% { transform: translateY(-5vh) translateX(0) rotate(0deg); opacity: 0; }
            10% { opacity: 0.8; }
            100% { transform: translateY(105vh) translateX(50px) rotate(360deg); opacity: 0; }
        }

        /* Intro Screen */
        #intro-screen {
            position: fixed;
            inset: 0;
            z-index: 150;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: opacity 0.8s ease, visibility 0.8s;
            padding: 20px;
            background: rgba(0,0,0,0.3); /* Slight dim for readability */
        }

        .intro-text {
            color: var(--purple-light);
            font-size: clamp(1.8rem, 6vw, 3rem);
            letter-spacing: 2px;
            animation: pulse-text 2s infinite ease-in-out;
            text-shadow: 0 0 15px rgba(216, 180, 254, 0.5);
            line-height: 1.4;
        }

        @keyframes pulse-text {
            0%, 100% { opacity: 0.7; transform: scale(0.98); }
            50% { opacity: 1; transform: scale(1.02); }
        }

        /* Main Stage */
        .main-stage {
            position: relative;
            z-index: 10;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.8s ease;
            opacity: 0;
            width: 100%;
        }

        .main-stage.visible {
            display: flex;
            opacity: 1;
        }

        /* Responsive Open State */
        .main-stage.open {
            transform: translateY(180px);
        }

        .envelope-container {
            position: relative;
            width: 320px;
            height: 220px;
            max-width: 90vw;
            cursor: pointer;
            animation: float-envelope 4s ease-in-out infinite;
            will-change: transform;
            transition: transform 0.2s ease-out;
        }

        @media (max-width: 400px) {
            .envelope-container {
                height: 200px;
            }
        }

        @keyframes float-envelope {
            0%, 100% { transform: translateY(0) rotateX(0); }
            50% { transform: translateY(-10px) rotateX(2deg); }
        }

        .envelope {
            position: relative;
            width: 100%;
            height: 100%;
            background: var(--purple-mid);
            border-radius: 0 0 12px 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.6);
        }

        .envelope-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%; 
            height: 0;
            border-style: solid;
            border-width: 120px 160px 0 160px;
            border-color: var(--purple-dark) transparent transparent transparent;
            border: none;
            height: 120px;
            background-color: var(--purple-dark);
            clip-path: polygon(0 0, 100% 0, 50% 100%);
            transform-origin: top;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 40;
        }

        @media (max-width: 340px) {
            .envelope-flap { height: 100px; }
        }

        .open .envelope-flap {
            transform: rotateX(180deg);
            z-index: 5;
        }

        .envelope-front {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            z-index: 30;
            overflow: hidden;
            border-radius: 0 0 12px 12px;
            pointer-events: none;
        }

        .fold-plate {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
        }
        
        .fold-left {
            background: var(--purple-mid);
            clip-path: polygon(0 0, 0 100%, 100% 100%);
            filter: brightness(0.9);
            width: 50%;
            left: 0;
        }
        
        .fold-right {
            background: var(--purple-mid);
            clip-path: polygon(100% 0, 0 100%, 100% 100%);
            filter: brightness(0.8);
            width: 50%;
            right: 0;
        }

        .fold-bottom {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 55%;
            background: var(--purple-mid);
            clip-path: polygon(0 100%, 50% 0, 100% 100%);
            filter: brightness(1.1);
            z-index: 31;
        }

        .wax-seal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: #be185d;
            border-radius: 50%;
            z-index: 45;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
            transition: all 0.4s ease;
            margin-top: -30px;
        }

        .wax-seal::after { content: '‚ù§'; color: #f9a8d4; font-size: 26px; }
        .open .wax-seal { opacity: 0; transform: translate(-50%, -50%) scale(0); pointer-events: none; }

        /* The Letter */
        .letter {
            position: absolute;
            bottom: 10px;
            left: 5%;
            width: 90%;
            height: 180px;
            background: var(--letter-bg);
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275), height 0.8s ease, top 0.8s ease;
            z-index: 15;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .open .letter {
            transform: translateY(-50%);
            height: min(500px, 70vh);
            top: -140px; 
            bottom: auto;
            z-index: 25;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            overflow-y: auto; 
            justify-content: flex-start; 
        }

        /* Hide scrollbar */
        .open .letter::-webkit-scrollbar { width: 0 !important; }
        .open .letter { -ms-overflow-style: none; scrollbar-width: none; }

        .letter-content {
            opacity: 0;
            width: 100%;
            height: auto; 
            min-height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            text-align: center;
            transition: opacity 0.5s ease 0.6s;
            color: var(--text-main);
            padding: 10px 0;
        }

        .open .letter-content { opacity: 1; }

        .romantic-font { font-family: 'Dancing Script', cursive; }
        
        .letter-h2 { 
            /* Decreased text size as requested */
            font-size: clamp(1.4rem, 4.5vw, 1.8rem); 
            margin-bottom: 10px; 
            color: var(--purple-dark); 
        }
        
        .letter-p { 
            font-size: clamp(1rem, 4vw, 1.1rem); 
            line-height: 1.6; 
            color: #374151; 
            max-width: 100%; 
            min-height: 80px;
            font-weight: 500;
        }
        
        .question-p { 
            font-size: clamp(1.4rem, 6vw, 1.8rem); 
            color: var(--pink-accent); 
            margin: 20px 0 15px 0;
            font-weight: bold; 
        }

        .signature {
            font-size: clamp(0.8rem, 3vw, 1rem);
            color: var(--purple-accent);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 20px;
            margin-bottom: 10px;
            text-shadow: 0 1px 1px rgba(0,0,0,0.1);
        }

        /* Buttons Styling */
        .btn-container { display: flex; gap: 15px; justify-content: center; align-items: center; flex-wrap: wrap; margin-bottom: 10px; }
        
        .btn-yes {
            background: linear-gradient(45deg, var(--purple-mid), var(--pink-accent));
            color: white;
            padding: 12px 35px;
            border-radius: 50px;
            border: none;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(236, 72, 153, 0.4);
            transition: all 0.3s;
            font-size: 1rem;
            -webkit-appearance: none;
        }
        .btn-yes:hover, .btn-yes:active { transform: scale(1.05); box-shadow: 0 6px 20px rgba(236, 72, 153, 0.6); }

        .btn-no {
            background: white;
            color: #9ca3af;
            padding: 8px 25px;
            border-radius: 50px;
            border: 1px solid #e5e7eb;
            font-size: 0.8rem;
            cursor: pointer;
            transition: opacity 0.2s;
            -webkit-appearance: none;
        }

        /* Success Screen */
        #success-screen {
            display: none;
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at center, #4c1d95 0%, #000 100%);
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 20px;
        }

        .success-h1 { 
            font-size: clamp(3rem, 15vw, 6rem); 
            color: var(--sakura-pink); 
            margin-bottom: 20px; 
            line-height: 1.1;
        }
        
        .success-p { 
            font-size: clamp(1rem, 4vw, 1.25rem); 
            font-weight: 300; 
            letter-spacing: 2px; 
            line-height: 1.5; 
            max-width: 600px;
        }
        
        .success-icons { 
            font-size: clamp(2rem, 8vw, 3.5rem); 
            margin-top: 30px; 
            display: flex; 
            gap: 15px; 
        }

        .btn-reset {
            margin-top: 40px;
            background: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            color: rgba(255,255,255,0.6);
            padding: 10px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        .btn-reset:hover { border-color: white; color: white; }

        #hint {
            position: absolute;
            bottom: -60px;
            width: 100%;
            text-align: center;
            color: var(--purple-accent);
            font-size: 1rem;
            animation: bounce 2s infinite;
            opacity: 0.9;
            pointer-events: none;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }

        /* Cursor blinking */
        .cursor {
            display: inline-block;
            width: 2px;
            height: 1em;
            background-color: var(--text-main);
            animation: blink 0.7s infinite;
            vertical-align: middle;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="sakura-container" id="sakura-bg"></div>

    <!-- Intro Step -->
    <div id="intro-screen" onclick="showEnvelope()">
        <h1 class="romantic-font intro-text">A letter has arrived for you...<br><span style="font-size:0.5em; opacity:0.8; font-family:'Quicksand'; display:block; margin-top:10px;">Tap to receive</span></h1>
    </div>

    <div class="main-stage" id="main-stage">
        <div class="envelope-container" id="envelope-wrapper" onclick="openEnvelope()">
            <div class="envelope-flap"></div>
            <div class="wax-seal"></div>
            
            <div class="envelope">
                <div class="envelope-front">
                    <div class="fold-plate fold-left"></div>
                    <div class="fold-plate fold-right"></div>
                    <div class="fold-bottom"></div>
                </div>

                <div class="letter" id="letter-el">
                    <div class="letter-content">
                        <div style="width: 100%; display: flex; flex-direction: column; align-items: center;">
                            <h2 class="romantic-font letter-h2">My Dearest Regina,</h2>
                            <p class="letter-p" id="typewriter-text"></p>
                        </div>
                        
                        <div style="width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 20px;">
                            <p class="romantic-font question-p">Will you be my Valentine?</p>
                            
                            <div class="btn-container">
                                <button onclick="handleYes(event)" class="btn-yes">Yes!</button>
                                <button id="no-btn" onmouseover="moveNo()" onclick="moveNo(event)" class="btn-no">No</button>
                            </div>
                            <div class="signature">Yours always in love, Salaam ‚ù§Ô∏è‚Çä ‚äπ</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="hint">Tap to open our heart üíú</div>
        </div>
    </div>

    <!-- Success Screen -->
    <div id="success-screen">
        <h1 class="romantic-font success-h1 animate-pulse">Yes!</h1>
        <p class="success-p">
            MY HEART IS COMPLETELY YOURS, REGINA.<br>
            <span style="color: var(--purple-accent)">I LOVE YOU, FOREVER!!!</span>
        </p>
        <div class="success-icons">
            <span>üå∏</span><span>üíç</span><span>üíú</span>
        </div>
        <button onclick="resetApp()" class="btn-reset">Start Again</button>
    </div>

    <canvas id="confetti-canvas" style="position: fixed; inset: 0; pointer-events: none; z-index: 201;"></canvas>

    <script>
        let animationFrameId;
        const letterText = "Every day with you feels like a journey I never want to rush, an adventure made beautiful simply because you are in it. With you, love feels natural, steady, and alive. And no matter where life carries us, my heart will always know where it belongs. Together Forever by your side.";
        let isTyping = false;

        function initSakura() {
            const container = document.getElementById('sakura-bg');
            container.innerHTML = '';
            const petalCount = window.innerWidth < 600 ? 25 : 40;
            
            for (let i = 0; i < petalCount; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                const size = Math.random() * 10 + 10;
                petal.style.width = `${size}px`;
                petal.style.height = `${size * 0.8}px`;
                petal.style.left = `${Math.random() * 100}vw`;
                petal.style.animationDelay = `-${Math.random() * 20}s`;
                petal.style.animationDuration = `${Math.random() * 10 + 10}s`;
                petal.style.backgroundColor = ['#ffd1dc', '#ffb7c5', '#ffffff'][Math.floor(Math.random()*3)];
                container.appendChild(petal);
            }
        }

        function showEnvelope() {
            const intro = document.getElementById('intro-screen');
            const stage = document.getElementById('main-stage');
            
            intro.style.opacity = '0';
            setTimeout(() => {
                intro.style.visibility = 'hidden';
                stage.style.display = 'flex';
                requestAnimationFrame(() => {
                    stage.classList.add('visible');
                });
            }, 800);
        }

        function openEnvelope() {
            const stage = document.getElementById('main-stage');
            if (!stage.classList.contains('open')) {
                stage.classList.add('open');
                document.getElementById('hint').style.display = 'none';
                
                setTimeout(() => {
                    typeWriter();
                }, 800);
            }
        }

        function typeWriter() {
            if(isTyping) return;
            isTyping = true;
            const element = document.getElementById('typewriter-text');
            element.innerHTML = ''; 
            let i = 0;
            
            function type() {
                if (i < letterText.length) {
                    element.innerHTML += letterText.charAt(i);
                    i++;
                    setTimeout(type, 30);
                } else {
                    element.innerHTML += '<span class="cursor"></span>';
                }
            }
            type();
        }

        function moveNo(e) {
            if (e) e.stopPropagation();
            const btn = document.getElementById('no-btn');
            const padding = 20;
            const x = Math.random() * (window.innerWidth - btn.offsetWidth - padding * 2) + padding;
            const y = Math.random() * (window.innerHeight - btn.offsetHeight - padding * 2) + padding;
            
            btn.style.position = 'fixed';
            btn.style.left = x + 'px';
            btn.style.top = y + 'px';
            btn.style.zIndex = '100'; 
        }

        function handleYes(e) {
            e.stopPropagation();
            document.getElementById('success-screen').style.display = 'flex';
            startSuccessAnimation();
        }

        function resetApp() {
            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            document.getElementById('success-screen').style.display = 'none';
            
            const stage = document.getElementById('main-stage');
            stage.classList.remove('open');
            stage.classList.remove('visible');
            stage.style.display = 'none';

            document.getElementById('typewriter-text').innerHTML = '';
            isTyping = false;

            const intro = document.getElementById('intro-screen');
            intro.style.visibility = 'visible';
            intro.style.opacity = '1';
            
            setTimeout(() => {
                document.getElementById('hint').style.display = 'block';
            }, 600);

            const noBtn = document.getElementById('no-btn');
            noBtn.style.position = 'static';
            noBtn.style.left = 'auto';
            noBtn.style.top = 'auto';
            
            initSakura();
        }

        function startSuccessAnimation() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const petals = [];
            const count = window.innerWidth < 600 ? 60 : 120;

            for (let i = 0; i < count; i++) {
                petals.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 8 + 4,
                    vx: Math.random() * 4 - 2,
                    vy: Math.random() * 3 + 2,
                    angle: Math.random() * 360,
                    spin: Math.random() * 5 - 2.5
                });
            }
            
            function draw() {
                if (document.getElementById('success-screen').style.display === 'none') return;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#ffb7c5';
                
                petals.forEach(p => {
                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.angle * Math.PI / 180);
                    ctx.beginPath();
                    ctx.moveTo(0, 0);
                    ctx.bezierCurveTo(p.size, -p.size, p.size * 2, p.size, 0, p.size);
                    ctx.bezierCurveTo(-p.size * 2, p.size, -p.size, -p.size, 0, 0);
                    ctx.fill();
                    ctx.restore();
                    
                    p.y += p.vy; 
                    p.x += p.vx; 
                    p.angle += p.spin;
                    
                    if (p.y > canvas.height) p.y = -20;
                    if (p.x > canvas.width) p.x = 0;
                    if (p.x < 0) p.x = canvas.width;
                });
                animationFrameId = requestAnimationFrame(draw);
            }
            draw();
        }

        window.addEventListener('resize', () => {
             const canvas = document.getElementById('confetti-canvas');
             canvas.width = window.innerWidth;
             canvas.height = window.innerHeight;
             initSakura();
        });

        window.onload = initSakura;
    </script>
</body>
</html>